<!DOCTYPE html>
<html lang="en">
<head>
<title>Masq Storage Client</title>
<script>
    
</script>
</head>
<body>
  <h1>ACME Masq App</h1>
  <p>
    <pre id="data"></pre>
  </p>
</body>
<script type="text/javascript" src="dist/masq.js"></script>
<script>
var pre = document.getElementById('data')
// var masqStore = new MasqClient('http://localhost:8081/')
var masqStore = new MasqClient()

// Your app data (store)
var appData = {}

// Load all remote app state on initial connect
var getRemoteData = function () {
  return masqStore.getAll()
}
masqStore.onConnect().then(getRemoteData).then(function (res) {
  // update your local store
  appData = res || appData
  console.log('Loaded app state:', appData)
  pre.innerText = JSON.stringify(appData)
}).catch(function (err) {
  console.log(err)
})

document.addEventListener('Sync', function (event) {
  if (masqStore) {
    masqStore.getAll().then(function (res) {
      // update your local store
      appData = res || appData
      console.log('Updated app state after sync:', appData)
      pre.innerText = JSON.stringify(appData)
    })
  }
})
</script>
</html>